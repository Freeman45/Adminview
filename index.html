<!DOCTYPE html>
<html>
<head><title>Admin Inbox</title></head>
<body>
    <h2>Admin Dashboard</h2>
    <button onclick="loadMessages()">Refresh Messages</button>
    <div id="inbox"></div>

    <script>
        const API = "YOUR_WEB_APP_URL"; // PASTE YOUR URL HERE

        async function loadMessages() {
            const res = await fetch(API);
            const data = await res.json();
            const container = document.getElementById('inbox');
            container.innerHTML = "";

            data.forEach(m => {
                const div = document.createElement('div');
                div.style = "border-bottom:1px solid #000; padding:10px;";
                div.innerHTML = `
                    <p><strong>From:</strong> ${m.alias} (${m.messageid})</p>
                    <p><strong>Msg:</strong> ${m.message}</p>
                    <textarea id="reply_${m.messageid}">${m.reply || ""}</textarea><br>
                    <button onclick="saveReply('${m.messageid}')">Save Reply</button>
                `;
                container.appendChild(div);
            });
        }

        async function saveReply(id) {
            const replyVal = document.getElementById(`reply_${id}`).value;
            await fetch(API, {
                method: "POST",
                body: JSON.stringify({
                    action: "updateReply",
                    messageId: id,
                    reply: replyVal
                })
            });
            alert("Reply Saved!");
            loadMessages();
        }

        loadMessages(); // Initial load
    </script>
</body>
</html>
